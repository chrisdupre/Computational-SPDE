\documentclass{amsart}
\usepackage{graphicx,amsfonts,amsthm,amsmath,amssymb,enumerate,enumitem,xcolor,commath,hyperref} % Required for inserting images
\usepackage{geometry}[margin=0.75in]
\usepackage{biblatex}[sorting=none]

\title{An Introduction to Computational Stochastic PDEs\\ Exercises: Chapter 2}
\author{Chris DuPre }
\date{April 2024}

\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem*{cor}{Corollary}

\theoremstyle{definition}
\newtheorem{defn}{Definition}[section]
\newtheorem{conj}{Conjecture}[section]
\newtheorem{exmp}{Example}[section]
\newtheorem{exer}{Exercise}[section]

\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Hil}{\mathcal{H}}
\newcommand{\E}{\mathcal{E}}
\DeclareMathOperator{\csch}{csch}
\DeclareMathOperator{\sech}{sech}

\newcommand{\tcr}[1]{\textcolor{red}{#1}}

\bibliography{Ref}

\begin{document}

\maketitle
\setcounter{section}{2}
\begin{exer}
    Let $V = H_0^1(a,b).$ Show that if Assumption 2.8 in \cite{lord2014introduction} holds, then $a(\cdot,\cdot): V\times V\to \R$ in (2.9) in \cite{lord2014introduction} is an inner product on $V.$
\end{exer}
\begin{proof}
Note that $a$ is clearly symmetric and linear in the first argument. It is also clearly non-negative along the diagonal. Thus, it suffices to show that it is non-degenerate. To see this, note that 
$$a(u,u) ^2= \int_{a}^b p(x) u'(x)^2 dx + \int_a^b q(x) u(x)^2 dx \geq p_0\int_{a}^b u'(x)^2 dx.$$
Thus $a(u,u) = 0$ implies that $\int_a^b u'(x)^2 dx$ which implies $u'(x) = 0$ a.s. As $u \in H_0^1(a,b)$, this implies that $u = 0.$ Thus $a(\cdot,\cdot)$ is a non-degenerate symmetric bilinear form, hence an inner product. 
\end{proof}

\begin{exer}
    Let $p,q$ satisfy the conditions of Assumption 2.8 in \cite{lord2014introduction}. Prove the norm equivalence $(2.14).$ In addition, show that the energy norm $\|\cdot \|_{E}$ is equivalent to the norm $\|\cdot \|_{H^1(a,b)}.$
\end{exer}
\begin{proof}
    To see the upper bounds, not that 
    $$\|u\|_{E}^2 \leq \max\left\{\|p\|_{\infty},\|q\|_{\infty}\right\} \left[\int_a^b u'(x)^2 dx + \int_a^b u(x)^2 dx\right] = \max\left\{\|p\|_{\infty},\|q\|_{\infty}\right\} \|u\|_{H^1(a,b)}^2.$$
    For the lower bound, note that 
    \begin{align*}
        \|u\|_{E}^2 & \geq p_0 \int_a^b u'(x)^2 dx = \frac{p_0}{1+K^2} \int_a^b u'(x)^2 dx + \frac{p_0 }{1+K^2} K^2 \int_a^b u'(x)^2 dx \\
        & \geq \frac{p_0}{1+K^2}\left[\int_a^b u'(x)^2 +u(x)^2 dx \right] = \frac{p_0}{1+K^2} \|u\|_{H^1(a,b)}^2.
    \end{align*}
    Where $K$ is the associated Poincar\'e inequality (take $K = \frac{b-a}{\pi}$). Collecting these gives
    $$\sqrt{\frac{p_0}{1+K^2}}\|u\|_{H^1(a,b)} \leq \|u\|_{E} \leq \max\left\{\sqrt{\|p\|_{\infty}},\sqrt{\|q\|_{\infty}}\right\}\|u\|_{H^1(a,b)}.$$
\end{proof}

\begin{exer}
    Let Assumption 2.8 hold. Assume, for contradiction, that there are two weak solutions $u_1,u_2$ satisfying (2.11) in \cite{lord2014introduction} and show that $u_1 = u_2$. Hence, deduce that (2.11) has at most one solution.
\end{exer}
\begin{proof}
Suppose there exists two solutions $u_1 \neq u_2$ that satisfy (2.11). Then for all $u\in H_0^1(a,b)$
$$a(u,u_1-u_2) = a(u,u_1)-a(u,u_2) = \ell(u)-\ell(u) = 0.$$ 
In particular, this applies for $u = u_1-u_2.$ Thus $\|u_1-u_2\|_{E} = 0.$ By equivalence of norms, $\|u_1-u_2\|_{H_0^1(a,b)} = 0.$ Therefore $u_1 = u_2$, contradiction $\Rightarrow\!\Leftarrow$. 
    
\end{proof}

\begin{exer}
    Let Assumption 2.1 in \cite{lord2014introduction} hold. Consider the operator $A$ given by (2.24) and let $G(x,y)$ denote the Green's function satisfying (2.25).
    \begin{enumerate}[label=\alph*.]
        \item Show that 
        $$G'(x,y_{+}) - G'(x,y_{-}) = \frac{-1}{p(y)},$$
        where $G'(x,y_{+})$ denotes the limit of $G'(x,y+\varepsilon)$ as $\varepsilon$ approaches $0$ from above and $G'(x,y_{-})$ is the limit as $\varepsilon$ approaches $0$ from below. 
        \item Suppose that $u_1,u_2 \in C^{2}([a,b])$ are non-zero functions such that $Au_i = 0$ for $i=1,2$ with $u_1(a)=u_2(b) = 0.$ Show that 
        $$G(x,y) = \begin{cases}
            Cu_1(x)u_2(y) & x\leq y\\
            Cu_2(x)u_1(y) & x>y
    \end{cases}$$
    for a constant that you should determine.
    \item Show that $G(x,y)$ is symmetric and belongs to $L^2\left([a,b]\times[a,b]\right).$
    \end{enumerate}
\end{exer}
\begin{proof}
    \begin{enumerate}[label=\alph*.]
        \item \tcr{Still to prove}
        \item \tcr{Still to prove}
        \item \tcr{Still to prove}
    \end{enumerate}
\end{proof}

\begin{exer}
    Fix the coefficients $p=1$ and $q=1.$ Using Algorithms $2.1$ and $2.2$, investigate the condition number of the matrices $A,K$ and $M$ on the finite element mesh width $h$.
\end{exer}
\begin{proof}
    \tcr{Still to prove}
\end{proof}

\begin{exer}
    Using $(2.36)$, show that the local quadratic basis functions associate with the nodes $x_1^k = 0, x_2^k = \frac{h}{2}, x_3^k = h$ on the element $e_k = [0,h]$ are 
    \begin{align*}
        \phi_1^k(x) = \frac{2x^2}{h^2}-\frac{3x}{h}+ 1, && \phi_2^k(x) = \frac{4x}{h}-\frac{4x^2}{h^2}, && \phi_3^k = \frac{2x^2}{h^2}-\frac{x}{h}.
    \end{align*}
    Assume that $q=0$ and $p$ and $f$ are constants. Compute the element vector $\mathbf{b}^k \in \R^3$ and show that the $3\times3$ element matrix $A^k$ for this specific element is 
    $$A^k = \frac{1}{3h}\begin{pmatrix}
        7 & -8 & 1 \\ -8 & 16 & -8\\ 1 & -8 & 7 
    \end{pmatrix}$$
\end{exer}
\begin{proof}
    Note that we seek $\phi_{j}^k(x)$ as a quadratic polynomial such that 
    $$\phi_{j}^k\left(x_l^k\right) = \delta_{jl}.$$
    This immediately allows us to write 
    \begin{align*}
        \phi_1^k(x) &= c_1 \left(x-\frac{h}{2}\right)\left(x-h\right) = c_1\left[x^2 - \frac{3xh}{2} + \frac{h^2}{2}\right]\\
        \phi_2^k(x) &= c_2 x\left(x-h\right)=  c_2\left[x^2 - hx\right]\\
        \phi_3^k(x) &= c_3 x\left(x-\frac{h}{2}\right) = c_3\left[x^2 - \frac{xh}{2}\right].
    \end{align*}
    We can solve for $c_1,c_2,c_3$ as follows
    \begin{gather*}
        \phi_1^k\left(\frac{h}{2}\right) = c_1 \frac{h^2}{2} = 1 \implies c_1 = \frac{2}{h^2}\\
        \phi_2^k\left(\frac{h}{2}\right) = c_2 \left[\frac{h^2}{4}-\frac{h^2}{2}\right] = -c_2 \frac{h^2}{4} = 1 \implies c_2 = \frac{-4}{h^2}\\
        \phi_3^k(h) = c_3 \frac{h^2}{2} = 1 \implies c_3 = \frac{2}{h^2}.
    \end{gather*}
    Plugging these back in give the desired expressions. 
    \par We can then compute $b^k$ by the following three integrals
    \begin{align*}
        \left(b^k\right)_1 &= \int_0^h f \phi_1^k(x) dx = f\int_0^h \frac{2x^2}{h^2}-\frac{3x}{h}+1 dx = f\left[\frac{2x^3}{3h^2}-\frac{3x^2}{2h}+x\right]_{x=0}^{x=h}\\
        &= f \left[\frac{2h}{3}-\frac{3h}{2}+h\right] = \frac{fh}{6}\\
        \left(b^k\right)_2 &= \int_0^h f \phi_2^k(x) dx = f\int_0^h \frac{4x}{h}-\frac{4x^2}{h^2} dx = f\left[\frac{2x^2}{h}-\frac{4x^3}{3h^2}\right]_{x=0}^{x=h}\\
        &= fh\left[2-\frac{4}{3}\right] = \frac{2fh}{3}\\
        \left(b^k\right)_3 &= \int_0^h f \phi_3^k(x) dx = \int_0^h f \phi_2^k(x) dx = f\int_0^h \frac{2x^2}{h^2}-\frac{x}{h} dx = f\left[\frac{2x^3}{3h^2}-\frac{x^2}{2h}\right]_{x=0}^{x=h}\\
        &= fh\left[\frac{2}{3}=\frac{1}{2}\right] = \frac{fh}{6} 
    \end{align*}
    Thus we have that $b^k = \frac{fh}{6}\begin{bmatrix}
        1 & 4 & 1
    \end{bmatrix}.$
    \par We then compute the entries of $A^k$ by computing the integrals
    $$\left(A_k\right)_{i,j} = \int_0^h p\frac{dx\phi_i^k}{dx}(x)\frac{dx\phi_j^k}{dx}(x) dx.$$
    It is clear this is symmetric, thus we only need to compute 6 integrals in theory. In fact, we can achieve less as $\phi_{3}^k(x) = \phi_{1}^{k}(h-x), \phi_2^k(x) = \phi_2^k(h-x)$. Therefore we have that 
    $\frac{d\phi_{3}^k}{dx}(x) = -\frac{d\phi_{1}^k}{dx}(h-x)$ and $\frac{d\phi_{2}^k}{dx}(x) = -\frac{d\phi_{2}^k}{dx} $and thus
    \begin{align*}
        \int_0^h \frac{d\phi_{1}^k}{dx}(x)\frac{d\phi_{1}^k}{dx}(x) dx = \int_0^h \frac{d\phi_{1}^k}{dx}(h-x)\frac{d\phi_{1}^k}{dx}(h-x) dx = \int_0^h \frac{d\phi_{3}^k}{dx}(x) \frac{d\phi_{3}^k}{dx}(x) dx\\
        \int_0^h \frac{d\phi_{1}^k}{dx}(x)\frac{d\phi_{2}^k}{dx}(x) dx = \int_0^h \frac{d\phi_{1}^k}{dx}(h-x)\frac{d\phi_{2}^k}{dx}(h-x) dx = \int_0^h \frac{d\phi_{3}^k}{dx}(x)\frac{d\phi_{2}^k}{dx}(x) dx. 
    \end{align*}
    Thus we only need to compute 4 integrals. Namely
    \begin{align*}
        \int_0^h \frac{d\phi_{1}^k}{dx}(x)\frac{d\phi_{1}^k}{dx}(x) dx &= \int_0^h \left(\frac{4x}{h^2}-\frac{3}{h}\right)^2 dx = \int_0^h \frac{16x^2}{h^4}-\frac{24x}{h^3}+\frac{9}{h^2} dx \\
        &= \left[\frac{16x^3}{3h^4}-\frac{12x^2}{h^3}+\frac{9x}{h^2} \right]_{x=0}^{x=h}\\
        &= \frac{1}{h}\left[\frac{16}{3}-12+9\right] =\frac{7}{3h}. \\
        \int_0^h \frac{d\phi_{2}^k}{dx}(x)\frac{d\phi_{2}^k}{dx}(x) dx &= \int_0^h \left(\frac{4}{h}-\frac{8x}{h}\right)^2 dx \\
        &= h^2\left[-\frac{\left(\frac{4}{h}-\frac{8x}{h^2}\right)^3}{24}\right]_{x=0}^{x=h}  = h^2 \left[\frac{64}{24h^3} - \frac{\left(4-8\right)^3}{24h^3}\right]\\
        &= \frac{128}{24h} = \frac{16}{3h}\\
        \int_0^h \frac{d\phi_{1}^k}{dx}\frac{d\phi_{2}^k}{dx} dx &= \int_0^h \left(\frac{4}{h}-\frac{8x}{h^2}\right)\left(\frac{4x}{h^2}-\frac{3}{h}\right) dx = \int_0^h \frac{16x}{h^3} - \frac{32x^2}{h^4} + \frac{24x}{h^3} - \frac{12}{h^2} dx \\
        &= \left[\frac{8x^2}{h^3} - \frac{32 x^3}{3h^4} + \frac{12 x^2}{h^3}-\frac{12x}{h^2}\right]_{x=0}^{x=h} = \frac{1}{h}\left[8-\frac{32}{3}+12-12\right] = \frac{-8}{3h}\\
        \int_0^h \frac{d\phi_{1}^k}{dx}\frac{d\phi_{3}^k}{dx}(x) dx &= \int_0^h \left(\frac{4x}{h^2}-\frac{3}{h}\right)\left(\frac{4x}{h^2} -\frac{1}{h}\right)dx = \int_0^h \frac{16x^2}{h^4}-\frac{12x}{h^3}-
        \frac{4x}{h^3} + \frac{3}{h^2}dx\\
        &= \left[\frac{16x^3}{3h^4}-\frac{6x^2}{h^3}-\frac{2x^2}{h^3} +\frac{3x}{h^2}\right]_{x=0}^{x=h} = \frac{1}{h}\left[\frac{16}{3}-6-2+3\right] = \frac{1}{3h}
    \end{align*}
    Plugging these in gives $A^k. $
\end{proof}

\begin{exer}
    Consider the BVP (2.3) on $D = (0,1)$ with non-homogeneous boundrary conditions $u(0)=\alpha$ and $u(1)=\beta.$ By writing 
    $$u_h(x) = a\phi_0(x) + \sum_{i=1}^{J} u_i \phi_i(x) + \beta \phi_{j+1}(x)$$
    where $\phi_0(x)$ and $\phi_{J+1}(x)$ are the hat functions associated with $x=0$ and $x=1$ respectively, derive the linear system $A\mathbf{u} = \hat{\mathbf{b}}$ to be solved for the interior values $u_i = u_h (z_i), i = 1,...,J.$ Relate this linear system to the one obtained for homogeneous conditions. Edit algorithm 2.1 and compute the finite element approximation to $(2.3)$ with the boundary conditions $u(0)=1$ and $u(1)=0$, for $p=1, q=10$ and $f=1.$
\end{exer}
\begin{proof}
    \tcr{Still to prove}
\end{proof}

\printbibliography
\end{document}